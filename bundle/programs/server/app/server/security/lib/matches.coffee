(function(){

/////////////////////////////////////////////////////////////////////////
//                                                                     //
// server/security/lib/matches.coffee                                  //
//                                                                     //
/////////////////////////////////////////////////////////////////////////
                                                                       //
__coffeescriptShare = typeof __coffeescriptShare === 'object' ? __coffeescriptShare : {}; var share = __coffeescriptShare;
var indexOf = [].indexOf;
Match.App = {
  Id: Match.Where(function (value) {
    check(value, String);

    if (indexOf.call(share.fixtureIds, value) >= 0) {
      return true; // verbose IDs
    }

    if (value.length !== 17 || _.difference(value.split(""), ["2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F", "G", "H", "J", "K", "L", "M", "N", "P", "Q", "R", "S", "T", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"]).length) {
      throw new Match.Error("Value \"" + value + "\" is not a valid ID");
    }

    return true;
  }),
  UserId: Match.Where(function (value) {
    check(value, Match.App.Id);

    if (!Meteor.users.findOne(value)) {
      throw new Match.Error("User with ID \"" + value + "\" doesn't exist");
    }

    return true;
  }),
  QueryId: Match.Where(function (value) {
    check(value, Match.App.Id);

    if (!share.Queries.findOne(value)) {
      throw new Match.Error("Query with ID \"" + value + "\" doesn't exist");
    }

    return true;
  }),
  IPSetId: Match.Where(function (value) {
    check(value, Match.App.Id);

    if (!share.IPSets.findOne(value)) {
      throw new Match.Error("IP Set with ID \"" + value + "\" doesn't exist");
    }

    return true;
  }),
  TupleId: Match.Where(function (value) {
    check(value, Match.App.Id);

    if (!share.Tuples.findOne(value)) {
      throw new Match.Error("Tuple file with ID \"" + value + "\" doesn't exist");
    }

    return true;
  }),
  isNewUpdate: function (oldValue) {
    return Match.Where(function (value) {
      check(value, Boolean);

      if (value && !oldValue) {
        throw new Match.Error("isNew update can't be true from false");
      }

      return true;
    });
  },
  InArray: function (possibleValues) {
    return Match.Where(function (value) {
      if (possibleValues.indexOf(value) === -1) {
        throw new Match.Error("Expected one of \"" + possibleValues.join("\", \"") + "\"; got \"" + value + "\"");
      }

      return true;
    });
  },
  UnsignedNumber: Match.Where(function (value) {
    check(value, Number);

    if (value < 0) {
      throw new Match.Error("Must be unsigned number");
    }

    return true;
  }),
  Email: Match.Where(function (value) {
    return value.match(share.emailRegex);
  })
};

_.extend(Match.App, {
  ExternalSource: Match.App.InArray(["trello"])
});
/////////////////////////////////////////////////////////////////////////

}).call(this);

//# sourceURL=meteor://ðŸ’»app/app/server/security/lib/matches.coffee
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1ldGVvcjovL/CfkrthcHAvc2VydmVyL3NlY3VyaXR5L2xpYi9tYXRjaGVzLmNvZmZlZSJdLCJuYW1lcyI6WyJpbmRleE9mIiwiTWF0Y2giLCJBcHAiLCJJZCIsIldoZXJlIiwidmFsdWUiLCJjaGVjayIsIlN0cmluZyIsImNhbGwiLCJzaGFyZSIsImZpeHR1cmVJZHMiLCJsZW5ndGgiLCJfIiwiZGlmZmVyZW5jZSIsInNwbGl0IiwiRXJyb3IiLCJVc2VySWQiLCJNZXRlb3IiLCJ1c2VycyIsImZpbmRPbmUiLCJRdWVyeUlkIiwiUXVlcmllcyIsIklQU2V0SWQiLCJJUFNldHMiLCJUdXBsZUlkIiwiVHVwbGVzIiwiaXNOZXdVcGRhdGUiLCJvbGRWYWx1ZSIsIkJvb2xlYW4iLCJJbkFycmF5IiwicG9zc2libGVWYWx1ZXMiLCJqb2luIiwiVW5zaWduZWROdW1iZXIiLCJOdW1iZXIiLCJFbWFpbCIsIm1hdGNoIiwiZW1haWxSZWdleCIsImV4dGVuZCIsIkV4dGVybmFsU291cmNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxJQUFBQSxPQUFBLE1BQUFBLE9BQUE7QUFBQUMsS0FBSyxDQUFDQyxHQUFOLEdBQ0U7QUFBQUMsSUFBQSxFQUFJRixLQUFLLENBQUNHLEtBQU4sQ0FBWSxVQUFDQyxLQUFEO0FBQ2RDLFNBQUEsQ0FBTUQsS0FBTixFQUFhRSxNQUFiOztBQUNBLFFBQUdQLE9BQUEsQ0FBQVEsSUFBQSxDQUFTQyxLQUFLLENBQUNDLFVBQWYsRUFBQUwsS0FBQSxNQUFIO0FBQ0UsYUFBTyxJQUFQLENBREY7QUFJQzs7QUFGRCxRQUFHQSxLQUFLLENBQUNNLE1BQU4sS0FBa0IsRUFBbEIsSUFBd0JDLENBQUMsQ0FBQ0MsVUFBRixDQUFhUixLQUFLLENBQUNTLEtBQU4sQ0FBWSxFQUFaLENBQWIsRUFBOEIsQ0FBQyxHQUFELEVBQU0sR0FBTixFQUFXLEdBQVgsRUFBZ0IsR0FBaEIsRUFBcUIsR0FBckIsRUFBMEIsR0FBMUIsRUFBK0IsR0FBL0IsRUFB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SyxDQUFDQyxHQUFOLENBQVUyQixPQUFWLENBQWtCLENBQUMsUUFBRCxDQUFsQjtBQUFoQixDQURGLEUiLCJmaWxlIjoiL3NlcnZlci9zZWN1cml0eS9saWIvbWF0Y2hlcy5jb2ZmZWUiLCJzb3VyY2VzQ29udGVudCI6WyJNYXRjaC5BcHAgPVxuICBJZDogTWF0Y2guV2hlcmUgKHZhbHVlKSAtPlxuICAgIGNoZWNrKHZhbHVlLCBTdHJpbmcpXG4gICAgaWYgdmFsdWUgaW4gc2hhcmUuZml4dHVyZUlkc1xuICAgICAgcmV0dXJuIHRydWUgIyB2ZXJib3NlIElEc1xuICAgIGlmIHZhbHVlLmxlbmd0aCBpc250IDE3IG9yIF8uZGlmZmVyZW5jZSh2YWx1ZS5zcGxpdChcIlwiKSwgW1wiMlwiLCBcIjNcIiwgXCI0XCIsIFwiNVwiLCBcIjZcIiwgXCI3XCIsIFwiOFwiLCBcIjlcIiwgXCJBXCIsIFwiQlwiLCBcIkNcIiwgXCJEXCIsIFwiRVwiLCBcIkZcIiwgXCJHXCIsIFwiSFwiLCBcIkpcIiwgXCJLXCIsIFwiTFwiLCBcIk1cIiwgXCJOXCIsIFwiUFwiLCBcIlFcIiwgXCJSXCIsIFwiU1wiLCBcIlRcIiwgXCJXXCIsIFwiWFwiLCBcIllcIiwgXCJaXCIsIFwiYVwiLCBcImJcIiwgXCJjXCIsIFwiZFwiLCBcImVcIiwgXCJmXCIsIFwiZ1wiLCBcImhcIiwgXCJpXCIsIFwialwiLCBcImtcIiwgXCJtXCIsIFwiblwiLCBcIm9cIiwgXCJwXCIsIFwicVwiLCBcInJcIiwgXCJzXCIsIFwidFwiLCBcInVcIiwgXCJ2XCIsIFwid1wiLCBcInhcIiwgXCJ5XCIsIFwielwiXSkubGVuZ3RoXG4gICAgICB0aHJvdyBuZXcgTWF0Y2guRXJyb3IoXCJWYWx1ZSBcXFwiXCIgKyB2YWx1ZSArIFwiXFxcIiBpcyBub3QgYSB2YWxpZCBJRFwiKVxuICAgIHRydWVcbiAgVXNlcklkOiBNYXRjaC5XaGVyZSAodmFsdWUpIC0+XG4gICAgY2hlY2sodmFsdWUsIE1hdGNoLkFwcC5JZClcbiAgICB1bmxlc3MgTWV0ZW9yLnVzZXJzLmZpbmRPbmUodmFsdWUpXG4gICAgICB0aHJvdyBuZXcgTWF0Y2guRXJyb3IoXCJVc2VyIHdpdGggSUQgXFxcIlwiICsgdmFsdWUgKyBcIlxcXCIgZG9lc24ndCBleGlzdFwiKVxuICAgIHRydWVcbiAgUXVlcnlJZDogTWF0Y2guV2hlcmUgKHZhbHVlKSAtPlxuICAgIGNoZWNrKHZhbHVlLCBNYXRjaC5BcHAuSWQpXG4gICAgdW5sZXNzIHNoYXJlLlF1ZXJpZXMuZmluZE9uZSh2YWx1ZSlcbiAgICAgIHRocm93IG5ldyBNYXRjaC5FcnJvcihcIlF1ZXJ5IHdpdGggSUQgXFxcIlwiICsgdmFsdWUgKyBcIlxcXCIgZG9lc24ndCBleGlzdFwiKVxuICAgIHRydWVcbiAgSVBTZXRJZDogTWF0Y2guV2hlcmUgKHZhbHVlKSAtPlxuICAgIGNoZWNrKHZhbHVlLCBNYXRjaC5BcHAuSWQpXG4gICAgdW5sZXNzIHNoYXJlLklQU2V0cy5maW5kT25lKHZhbHVlKVxuICAgICAgdGhyb3cgbmV3IE1hdGNoLkVycm9yKFwiSVAgU2V0IHdpdGggSUQgXFxcIlwiICsgdmFsdWUgKyBcIlxcXCIgZG9lc24ndCBleGlzdFwiKVxuICAgIHRydWVcbiAgVHVwbGVJZDogTWF0Y2guV2hlcmUgKHZhbHVlKSAtPlxuICAgIGNoZWNrKHZhbHVlLCBNYXRjaC5BcHAuSWQpXG4gICAgdW5sZXNzIHNoYXJlLlR1cGxlcy5maW5kT25lKHZhbHVlKVxuICAgICAgdGhyb3cgbmV3IE1hdGNoLkVycm9yKFwiVHVwbGUgZmlsZSB3aXRoIElEIFxcXCJcIiArIHZhbHVlICsgXCJcXFwiIGRvZXNuJ3QgZXhpc3RcIilcbiAgICB0cnVlXG4gIGlzTmV3VXBkYXRlOiAob2xkVmFsdWUpIC0+XG4gICAgTWF0Y2guV2hlcmUgKHZhbHVlKSAtPlxuICAgICAgY2hlY2sodmFsdWUsIEJvb2xlYW4pXG4gICAgICBpZiB2YWx1ZSBhbmQgbm90IG9sZFZhbHVlXG4gICAgICAgIHRocm93IG5ldyBNYXRjaC5FcnJvcihcImlzTmV3IHVwZGF0ZSBjYW4ndCBiZSB0cnVlIGZyb20gZmFsc2VcIilcbiAgICAgIHRydWVcbiAgSW5BcnJheTogKHBvc3NpYmxlVmFsdWVzKSAtPlxuICAgIE1hdGNoLldoZXJlICh2YWx1ZSkgLT5cbiAgICAgIGlmIHBvc3NpYmxlVmFsdWVzLmluZGV4T2YodmFsdWUpID09IC0xXG4gICAgICAgIHRocm93IG5ldyBNYXRjaC5FcnJvcihcIkV4cGVjdGVkIG9uZSBvZiBcXFwiXCIrcG9zc2libGVWYWx1ZXMuam9pbihcIlxcXCIsIFxcXCJcIikrXCJcXFwiOyBnb3QgXFxcIlwiICsgdmFsdWUgKyBcIlxcXCJcIilcbiAgICAgIHRydWVcbiAgVW5zaWduZWROdW1iZXI6IE1hdGNoLldoZXJlICh2YWx1ZSkgLT5cbiAgICBjaGVjayh2YWx1ZSwgTnVtYmVyKVxuICAgIGlmIHZhbHVlIDwgMFxuICAgICAgdGhyb3cgbmV3IE1hdGNoLkVycm9yKFwiTXVzdCBiZSB1bnNpZ25lZCBudW1iZXJcIilcbiAgICB0cnVlXG4gIEVtYWlsOiBNYXRjaC5XaGVyZSAodmFsdWUpIC0+XG4gICAgdmFsdWUubWF0Y2goc2hhcmUuZW1haWxSZWdleClcbl8uZXh0ZW5kKE1hdGNoLkFwcCxcbiAgRXh0ZXJuYWxTb3VyY2U6IE1hdGNoLkFwcC5JbkFycmF5KFtcInRyZWxsb1wiXSlcbilcbiJdfQ==
