{"version":3,"sources":["meteor://ðŸ’»app/server/security/users.coffee"],"names":["Meteor","users","allow","insert","share","securityRulesWrapper","userId","user","update","fieldNames","modifier","Security","hasRole","Match","Error","remove","_id"],"mappings":";;;;;;;;;AAAAA,MAAM,CAACC,KAAP,CAAaC,KAAb,CACE;AAAAC,QAAA,EAAQC,KAAK,CAACC,oBAAN,CAA2B,UAACC,MAAD,EAASC,IAAT;AACjC;AADM,IAAR;AAEAC,QAAA,EAAQJ,KAAK,CAACC,oBAAN,CAA2B,UAACC,MAAD,EAASC,IAAT,EAAeE,UAAf,EAA2BC,QAA3B;AACjC,SAAON,KAAK,CAACO,QAAN,CAAeC,OAAf,CAAuBN,MAAvB,EAA+B,OAA/B,CAAP;AACE,YAAM,IAAIO,KAAK,CAACC,KAAV,CAAgB,sCAAhB,CAAN;AAED;;AACD,WAFA,IAEA;AALM,IAFR;AAMAC,QAAA,EAAQX,KAAK,CAACC,oBAAN,CAA2B,UAACC,MAAD,EAASC,IAAT;AACjC,SAAOD,MAAP;AACE,YAAM,IAAIO,KAAK,CAACC,KAAV,CAAgB,8CAAhB,CAAN;AAID;;AAHD,QAAGR,MAAA,KAAUC,IAAI,CAACS,GAAlB;AACE,YAAM,IAAIH,KAAK,CAACC,KAAV,CAAgB,2BAAhB,CAAN;AAKD;;AAJD,SAAOV,KAAK,CAACO,QAAN,CAAeC,OAAf,CAAuBN,MAAvB,EAA+B,OAA/B,CAAP;AACE,YAAM,IAAIO,KAAK,CAACC,KAAV,CAAgB,sCAAhB,CAAN;AAMD;;AACD,WANA,IAMA;AAbM;AANR,CADF,E","file":"/server/security/users.coffee","sourcesContent":["Meteor.users.allow\n  insert: share.securityRulesWrapper (userId, user) ->\n    false\n  update: share.securityRulesWrapper (userId, user, fieldNames, modifier) ->\n    unless share.Security.hasRole(userId, \"admin\")\n      throw new Match.Error(\"Operation not allowed for non admins\")\n    true\n  remove: share.securityRulesWrapper (userId, user) ->\n    unless userId\n      throw new Match.Error(\"Operation not allowed for unauthorized users\")\n    if userId is user._id\n      throw new Match.Error(\"User can't remove himself\")\n    unless share.Security.hasRole(userId, \"admin\")\n      throw new Match.Error(\"Operation not allowed for non admins\")\n    true\n"]}