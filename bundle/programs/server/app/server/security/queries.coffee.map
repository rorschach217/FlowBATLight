{"version":3,"sources":["meteor://ðŸ’»app/server/security/queries.coffee"],"names":["share","Queries","allow","insert","securityRulesWrapper","userId","query","Match","Error","_id","Random","id","ownerId","check","App","Id","name","String","cmd","exclusionsCmd","startDateType","startDateOffsetEnabled","Boolean","startDateOffset","startDateEnabled","startDate","endDateEnabled","endDate","sensorEnabled","sensor","typesEnabled","types","daddressEnabled","daddress","saddressEnabled","saddress","anyAddressEnabled","anyAddress","dipSetEnabled","dipSet","OneOf","IPSetId","sipSetEnabled","sipSet","anySetEnabled","anySet","tupleFileEnabled","tupleFile","TupleId","tupleDirectionEnabled","tupleDirection","tupleDelimiterEnabled","tupleDelimiter","tupleFieldsEnabled","tupleFields","dportEnabled","dport","sportEnabled","sport","aportEnabled","aport","dccEnabled","dcc","sccEnabled","scc","protocolEnabled","protocol","flagsAllEnabled","flagsAll","activeTimeEnabled","activeTime","additionalParametersEnabled","additionalParameters","additionalExclusionsCmdEnabled","additionalExclusionsCmd","fields","fieldsOrder","rwstatsDirection","rwstatsMode","rwstatsCountModeValue","rwstatsThresholdModeValue","rwstatsPercentageModeValue","rwstatsBinTimeEnabled","rwstatsBinTime","rwstatsFields","rwstatsFieldsOrder","rwstatsValues","rwstatsValuesOrder","rwstatsPrimaryValue","rwstatsCmd","rwcountBinSizeEnabled","rwcountBinSize","rwcountLoadSchemeEnabled","rwcountLoadScheme","rwcountSkipZeroes","rwcountCmd","rwcountFields","result","error","interface","output","presentation","chartType","chartHeight","Integer","chartHiddenFields","expandedFieldsets","executingInterval","executingAt","Date","startRecNum","sortField","sortReverse","isInputStale","isOutputStale","isUTC","isQuick","isNew","UserId","updatedAt","createdAt","update","fieldNames","modifier","options","$addToSet","$pull","$set","Optional","isNewUpdate","remove"],"mappings":"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","file":"/server/security/queries.coffee","sourcesContent":["share.Queries.allow\n  insert: share.securityRulesWrapper (userId, query) ->\n    unless userId\n      throw new Match.Error(\"Operation not allowed for unauthorized users\")\n    query._id = query._id or Random.id()\n    query.ownerId = userId\n    check(query,\n      _id: Match.App.Id\n      name: String\n      cmd: String\n      exclusionsCmd: String\n      startDateType: String\n      startDateOffsetEnabled: Boolean\n      startDateOffset: String\n      startDateEnabled: Boolean\n      startDate: String\n      endDateEnabled: Boolean\n      endDate: String\n      sensorEnabled: Boolean\n      sensor: String\n      typesEnabled: Boolean\n      types: [String]\n      daddressEnabled: Boolean\n      daddress: String\n      saddressEnabled: Boolean\n      saddress: String\n      anyAddressEnabled: Boolean\n      anyAddress: String\n      dipSetEnabled: Boolean\n      dipSet: Match.OneOf(null, Match.App.IPSetId)\n      sipSetEnabled: Boolean\n      sipSet: Match.OneOf(null, Match.App.IPSetId)\n      anySetEnabled: Boolean\n      anySet: Match.OneOf(null, Match.App.IPSetId)\n      tupleFileEnabled: Boolean\n      tupleFile: Match.OneOf(null, Match.App.TupleId)\n      tupleDirectionEnabled: Boolean\n      tupleDirection: String\n      tupleDelimiterEnabled: Boolean\n      tupleDelimiter: String\n      tupleFieldsEnabled: Boolean\n      tupleFields: String\n      dportEnabled: Boolean\n      dport: String\n      sportEnabled: Boolean\n      sport: String\n      aportEnabled: Boolean\n      aport: String\n      dccEnabled: Boolean\n      dcc: [String]\n      sccEnabled: Boolean\n      scc: [String]\n      protocolEnabled: Boolean\n      protocol: String\n      flagsAllEnabled: Boolean\n      flagsAll: String\n      activeTimeEnabled: Boolean\n      activeTime: String\n      additionalParametersEnabled: Boolean\n      additionalParameters: String\n      additionalExclusionsCmdEnabled: Boolean\n      additionalExclusionsCmd: String\n      fields: [String]\n      fieldsOrder: [String]\n      rwstatsDirection: String\n      rwstatsMode: String\n      rwstatsCountModeValue: String\n      rwstatsThresholdModeValue: String\n      rwstatsPercentageModeValue: String\n      rwstatsBinTimeEnabled: Boolean\n      rwstatsBinTime: String\n      rwstatsFields: [String]\n      rwstatsFieldsOrder: [String]\n      rwstatsValues: [String]\n      rwstatsValuesOrder: [String]\n      rwstatsPrimaryValue: String\n      rwstatsCmd: String\n      rwcountBinSizeEnabled: Boolean\n      rwcountBinSize: String\n      rwcountLoadSchemeEnabled: Boolean\n      rwcountLoadScheme: String\n      rwcountSkipZeroes: Boolean\n      rwcountCmd: String\n      rwcountFields: [String]\n      result: String\n      error: String\n      interface: String\n      output: String\n      presentation: String\n      chartType: String\n      chartHeight: Match.Integer\n      chartHiddenFields: [String]\n      expandedFieldsets: [String]\n      executingInterval: Match.Integer\n      executingAt: Match.OneOf(null, Date)\n      startRecNum: Match.Integer\n      sortField: String\n      sortReverse: Boolean\n      isInputStale: Boolean\n      isOutputStale: Boolean\n      isUTC: Boolean\n      isQuick: Boolean\n      isNew: Boolean\n      ownerId: Match.App.UserId\n      updatedAt: Date\n      createdAt: Date\n    )\n    true\n  update: share.securityRulesWrapper (userId, query, fieldNames, modifier, options) ->\n    unless userId\n      throw new Match.Error(\"Operation not allowed for unauthorized users\")\n    unless userId is query.ownerId\n      throw new Match.Error(\"Operation not allowed for non-owners\")\n    $set =\n      name: Match.Optional(String)\n      cmd: Match.Optional(String)\n      exclusionsCmd: Match.Optional(String)\n      startDateType: Match.Optional(String)\n      startDateOffsetEnabled: Match.Optional(Boolean)\n      startDateOffset: Match.Optional(String)\n      startDateEnabled: Match.Optional(Boolean)\n      startDate: Match.Optional(String)\n      endDateEnabled: Match.Optional(Boolean)\n      endDate: Match.Optional(String)\n      sensorEnabled: Match.Optional(Boolean)\n      sensor: Match.Optional(String)\n      typesEnabled: Match.Optional(Boolean)\n      types: Match.Optional([String])\n      daddressEnabled: Match.Optional(Boolean)\n      daddress: Match.Optional(String)\n      saddressEnabled: Match.Optional(Boolean)\n      saddress: Match.Optional(String)\n      anyAddressEnabled: Match.Optional(Boolean)\n      anyAddress: Match.Optional(String)\n      dipSetEnabled: Match.Optional(Boolean)\n      dipSet: Match.Optional(Match.OneOf(null, Match.App.IPSetId))\n      sipSetEnabled: Match.Optional(Boolean)\n      sipSet: Match.Optional(Match.OneOf(null, Match.App.IPSetId))\n      anySetEnabled: Match.Optional(Boolean)\n      anySet: Match.Optional(Match.OneOf(null, Match.App.IPSetId))\n      tupleFileEnabled: Match.Optional(Boolean)\n      tupleFile: Match.Optional(Match.OneOf(null, Match.App.TupleId))\n      tupleDirectionEnabled: Match.Optional(Boolean)\n      tupleDirection: Match.Optional(String)\n      tupleDelimiterEnabled: Match.Optional(Boolean)\n      tupleDelimiter: Match.Optional(String)\n      tupleFieldsEnabled: Match.Optional(Boolean)\n      tupleFields: Match.Optional(String)\n      dportEnabled: Match.Optional(Boolean)\n      dport: Match.Optional(String)\n      sportEnabled: Match.Optional(Boolean)\n      sport: Match.Optional(String)\n      aportEnabled: Match.Optional(Boolean)\n      aport: Match.Optional(String)\n      dccEnabled: Match.Optional(Boolean)\n      dcc: Match.Optional([String])\n      sccEnabled: Match.Optional(Boolean)\n      scc: Match.Optional([String])\n      protocolEnabled: Match.Optional(Boolean)\n      protocol: Match.Optional(String)\n      flagsAllEnabled: Match.Optional(Boolean)\n      flagsAll: Match.Optional(String)\n      activeTimeEnabled: Match.Optional(Boolean)\n      activeTime: Match.Optional(String)\n      additionalParametersEnabled: Match.Optional(Boolean)\n      additionalParameters: Match.Optional(String)\n      additionalExclusionsCmdEnabled: Match.Optional(Boolean)\n      additionalExclusionsCmd: Match.Optional(String)\n      fields: Match.Optional([String])\n      fieldsOrder: Match.Optional([String])\n      rwstatsDirection: Match.Optional(String)\n      rwstatsMode: Match.Optional(String)\n      rwstatsCountModeValue: Match.Optional(String)\n      rwstatsThresholdModeValue: Match.Optional(String)\n      rwstatsPercentageModeValue: Match.Optional(String)\n      rwstatsBinTimeEnabled: Match.Optional(Boolean)\n      rwstatsBinTime: Match.Optional(String)\n      rwstatsFields: Match.Optional([String])\n      rwstatsFieldsOrder: Match.Optional([String])\n      rwstatsValues: Match.Optional([String])\n      rwstatsValuesOrder: Match.Optional([String])\n      rwstatsPrimaryValue: Match.Optional(String)\n      rwstatsCmd: Match.Optional(String)\n      rwcountBinSizeEnabled: Match.Optional(Boolean)\n      rwcountBinSize: Match.Optional(String)\n      rwcountLoadSchemeEnabled: Match.Optional(Boolean)\n      rwcountLoadScheme: Match.Optional(String)\n      rwcountSkipZeroes: Match.Optional(Boolean)\n      rwcountCmd: Match.Optional(String)\n      rwcountFields: Match.Optional([String])\n      result: Match.Optional(String)\n      error: Match.Optional(String)\n      interface: Match.Optional(String)\n      output: Match.Optional(String)\n      presentation: Match.Optional(String)\n      chartType: Match.Optional(String)\n      chartHeight: Match.Optional(Match.Integer)\n      chartHiddenFields: Match.Optional([String])\n      expandedFieldsets: Match.Optional([String])\n      executingInterval: Match.Optional(Match.Integer)\n      executingAt: Match.Optional(Match.OneOf(null, Date))\n      startRecNum: Match.Optional(Match.Integer)\n      sortField: Match.Optional(String)\n      sortReverse: Match.Optional(Boolean)\n      isInputStale: Match.Optional(Boolean)\n      isOutputStale: Match.Optional(Boolean)\n      isUTC: Match.Optional(Boolean)\n      isQuick: Match.Optional(Boolean)\n      isNew: Match.Optional(Match.App.isNewUpdate(query.isNew))\n      updatedAt: Date\n    $addToSet =\n      fields: Match.Optional(String)\n      rwstatsFields: Match.Optional(String)\n      rwstatsValues: Match.Optional(String)\n      rwcountFields: Match.Optional(String)\n      expandedFieldsets: Match.Optional(String)\n      chartHiddenFields: Match.Optional(String)\n    $pull =\n      fields: Match.Optional(String)\n      rwstatsFields: Match.Optional(String)\n      rwstatsValues: Match.Optional(String)\n      rwcountFields: Match.Optional(String)\n      expandedFieldsets: Match.Optional(String)\n      chartHiddenFields: Match.Optional(String)\n    check(modifier,\n      $set: Match.Optional($set)\n      $addToSet: Match.Optional($addToSet)\n      $pull: Match.Optional($pull)\n    )\n    true\n  remove: share.securityRulesWrapper (userId, query) ->\n    unless userId\n      throw new Match.Error(\"Operation not allowed for unauthorized users\")\n    unless userId is query.ownerId\n      throw new Match.Error(\"Operation not allowed for non-owners\")\n    true\n"]}