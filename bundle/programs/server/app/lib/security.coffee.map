{"version":3,"sources":["meteor://ðŸ’»app/lib/security.coffee"],"names":["indexOf","share","Security","effectiveRoles","admin","analyst","groups","Object","keys","currentUserHasRole","role","hasRole","Meteor","userId","userIdCanChangeUserGroupOrRemove","user","_id","users","findOne","call","group"],"mappings":";;;;;;;;;AAAA,IAAAA,OAAA,MAAAA,OAAA;AAAAC,KAAK,CAACC,QAAN,GACE;AAAAC,gBAAA,EACE;AAAAC,SAAA,EAAO,CAAC,OAAD,EAAU,SAAV,CAAP;AACAC,WAAA,EAAS,CAAC,OAAD,EAAU,SAAV;AADT,GADF;AAGAC,QAAA,EAAQ;AAIN,WAHAC,MAAM,CAACC,IAAP,CAAY,KAACL,cAAb,CAGA;AAPF;AAKAM,oBAAA,EAAoB,UAACC,IAAD;AAKlB,WAJAT,KAAK,CAACC,QAAN,CAAeS,OAAf,CAAuBC,MAAM,CAACC,MAAP,EAAvB,EAAwCH,IAAxC,CAIA;AAVF;AAOAI,kCAAA,EAAkC,UAACD,MAAD,EAASE,IAAT;AAMhC,WALAF,MAAA,KAAYE,IAAI,CAACC,GAAjB,IAAyB,KAACL,OAAD,CAASE,MAAT,EAAiB,OAAjB,CAKzB;AAbF;AASAF,SAAA,EAAS,UAACE,MAAD,EAASH,IAAT;AACP,QAAAK,IAAA;AAAAA,QAAA,GAAOH,MAAM,CAACK,KAAP,CAAaC,OAAb,CAAqBL,MAArB,CAAP;;AACA,QAAGE,IAAH;AACE,UAAGf,OAAA,CAAAmB,IAAA,CAAQlB,KAAK,CAACC,QAAN,CAAeC,cAAf,CAA8BY,IAAI,CAACK,KAAnC,CAAR,EAAAV,IAAA,MAAH;AACE,eAAO,IAAP;AAFJ;AAWC;;AARD,WAAO,KAAP;AALO;AATT,CADF,C","file":"/lib/security.coffee","sourcesContent":["share.Security =\n  effectiveRoles:\n    admin: [\"admin\", \"analyst\"]\n    analyst: [\"admin\", \"analyst\"]\n  groups: ->\n    Object.keys(@effectiveRoles)\n  currentUserHasRole: (role) ->\n    share.Security.hasRole(Meteor.userId(), role)\n  userIdCanChangeUserGroupOrRemove: (userId, user) ->\n    userId isnt user._id and @hasRole(userId, \"admin\")\n  hasRole: (userId, role) ->\n    user = Meteor.users.findOne(userId)\n    if user\n      if role in share.Security.effectiveRoles[user.group]\n        return true\n    return false\n"]}