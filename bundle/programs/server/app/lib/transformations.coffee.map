{"version":3,"sources":["meteor://ðŸ’»app/lib/transformations.coffee"],"names":["indexOf","share","User","constructor","doc","ref","ref1","_","extend","email","emails","address","name","profile","firstName","split","slice","join","lastName","Config","wrapCommand","command","getSSHOptions","port","user","host","getIdentityFile","identityFile","process","env","PWD","Query","distinctRegex","filteredHeader","i","index","j","k","l","len","len1","len2","len3","len4","len5","m","n","o","parsedResult","parsedRow","parsedValue","rawHeader","row","spec","header","rows","result","parseResult","output","shift","unshift","rwcountFields","length","_id","trim","isDistinct","isPercentage","substr","match","replace","chartType","chartFieldTypes","push","presentation","call","parseFloat","moment","utc","toDate","value","queryId","displayName","isQuick","inputCommand","config","isPresentation","exclusion","pcapFile","pcapFileValidate","rwFileValidate","typeValidate","inputOptions","interface","search","RegExp","siteConfigFile","dataRootdir","inputExclusions","dataTempdir","isSSH","eTimeMoment","parameters","sTimeMoment","startDateOffsetNumber","string","typesEnabled","types","difference","queryTypes","startDateType","startDateEnabled","startDate","endDateEnabled","endDate","activeTimeEnabled","activeTime","startDateOffsetEnabled","startDateOffset","intval","clone","subtract","format","sensorEnabled","sensor","daddressEnabled","daddress","saddressEnabled","saddress","anyAddressEnabled","anyAddress","dipSetEnabled","dipSet","sipSetEnabled","sipSet","anySetEnabled","anySet","tupleFileEnabled","tupleFile","tupleDirectionEnabled","tupleDirection","tupleDelimiterEnabled","tupleDelimiter","tupleFieldsEnabled","tupleFields","dportEnabled","dport","sportEnabled","sport","aportEnabled","aport","dccEnabled","dcc","sccEnabled","scc","protocolEnabled","protocol","flagsAllEnabled","flagsAll","additionalParametersEnabled","additionalParameters","cmd","filterOptions","exclusionsCmd","additionalExclusionsCmdEnabled","additionalExclusionsCmd","compact","outputCommand","outputRwcutCommand","outputRwstatsCommand","outputRwcountCommand","commands","rwcutOptions","rwcutOptionsString","rwsortOptions","rwsortOptionsString","sortField","sortReverse","numRecs","startRecNum","fields","intersection","fieldsOrder","defaultRwstatsOptions","rwstatsOptions","rwstatsOptionsString","rwstatsValues","rwstatsValuesOrder","values","rwstatsFields","rwstatsFieldsOrder","rwstatsPrimaryValue","rwstatsDirection","rwstatsMode","rwstatsCountModeValue","rwstatsThresholdModeValue","rwstatsPercentageModeValue","rwstatsBinTimeEnabled","rwstatsBinTime","rwstatsCmd","defaultRwcountOptions","fieldIndex","headCommand","headOptions","rwcountOptions","rwcountOptionsString","sortCommand","sortOptions","tailCommand","tailOptions","rwcountBinSizeEnabled","rwcountBinSize","rwcountLoadSchemeEnabled","rwcountLoadScheme","rwcountSkipZeroes","rwcountCmd","rwstatsCountModeValueIsEnabled","rwstatsThresholdModeValueIsEnabled","rwstatsPercentageModeValueIsEnabled","availableChartTypes","path","IPSet","objectSelectName","objectSelectValue","Tuple","Transformations","query","ipset","tuple"],"mappings":"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","file":"/lib/transformations.coffee","sourcesContent":["# not used by default\nclass share.User\n  constructor: (doc) ->\n    _.extend(@, doc)\n    @email = @emails?[0]?.address\n    @name = @profile.name\n    @firstName = @name.split(' ').slice(0, 1).join(' ')\n    @lastName = @name.split(' ').slice(1).join(' ')\n\nclass share.Config\n  constructor: (doc) ->\n    _.extend(@, doc)\n  wrapCommand: (command) ->\n    \"ssh \" + @getSSHOptions() + \" -p \" + @port +  \" \" + @user + \"@\" + @host + \" \\\"\" + command + \"\\\"\"\n  getSSHOptions: ->\n    \"-o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null -o LogLevel=error -i \" + @getIdentityFile()\n  getIdentityFile: ->\n    if @identityFile then @identityFile else process.env.PWD + \"/settings/identity\"\n\nclass share.Query\n  constructor: (doc) ->\n    _.extend(@, doc)\n    @header = []\n    @rows = []\n    if @result\n      parsedResult = share.parseResult(@result)\n      if @output is \"rwstats\"\n        parsedResult.shift()\n        parsedResult.shift()\n        # shift-shift outta here, you redundant rows\n      if @output is \"rwcount\"\n        parsedResult.unshift(share.rwcountFields)\n      rawHeader = parsedResult.shift()\n      for name in rawHeader\n        spec =\n          _id: name\n          name: name.trim()\n          isDistinct: false\n          isPercentage: false\n        if spec.name.indexOf(\"%\") is 0\n          spec.isPercentage = true\n          spec.name = spec.name.substr(1)\n        distinctRegex = /-D.*$/i\n        if spec.name.match(distinctRegex)\n          spec.isDistinct = true\n          spec.name = spec.name.replace(distinctRegex, \"\")\n        if spec.isDistinct\n          spec.chartType = \"number\"\n        else\n          spec.chartType = share.chartFieldTypes[spec.name] or \"string\"\n        @header.push(spec)\n      if @presentation is \"chart\"\n        for parsedRow in parsedResult\n          row = []\n          for parsedValue, index in parsedRow\n            spec = @header[index]\n            if @output is \"rwcount\" and spec.name not in @rwcountFields\n              continue\n            switch spec.chartType\n              when \"number\"\n                parsedValue = parseFloat(parsedValue)\n              when \"date\", \"datetime\"\n                m = moment.utc(parsedValue, \"YYYY/MM/DDTHH:mm:ss.SSS\")\n                parsedValue = m.toDate()\n            row.push(parsedValue)\n          @rows.push(row)\n      else\n        for parsedRow in parsedResult\n          row = []\n          for parsedValue, index in parsedRow\n            spec = @header[index]\n            row.push({_id: spec._id, value: parsedValue, queryId: @_id})\n          @rows.push(row)\n      filteredHeader = []\n      for spec in @header\n        filteredHeader.push(spec)\n      @header = filteredHeader\n  displayName: ->\n    if @isQuick then \"Quick query #\" + @_id else @name or \"#\" + @_id\n  inputCommand: (config, profile, isPresentation = false) ->\n    command = \"rwfilter\"\n    command += \" \" + @inputOptions(config)\n    # defaults to having --type=all as the standard instead of the SiLK default.\n    if @interface is \"cmd\"\n      typeValidate = command.search(RegExp('--type', 'i'))\n      if typeValidate < 0\n        command += \" --type=all \"\n    if config.siteConfigFile\n      command += \" --site-config-file=\" + config.siteConfigFile\n    # rwf and pcap integration\n    rwFileValidate = command.search(RegExp(' (\\\\/|\\\\w)+(\\\\/|\\\\w|\\\\-)*\\\\.(rwf|rw)', 'i'))\n    if rwFileValidate < 0\n      pcapFileValidate = command.search(RegExp(' (\\\\/|\\\\w)+(\\\\/|\\\\w|\\\\-)*\\\\.(pcap)', 'i'))\n      if pcapFileValidate >= 0\n        pcapFile = command.match(RegExp('(\\\\/|\\\\w)+(\\\\/|\\\\w|\\\\-)*\\\\.(pcap)', 'i'))\n        command += \" --input-pipe=stdin\"\n        command = command.replace(pcapFile[0],\"\")\n        command = \"rwp2yaf2silk --in=\" + pcapFile[0] + \" --out=- |\" + command\n      else\n        if config.dataRootdir\n          command += \" --data-rootdir=\" + config.dataRootdir\n\n    command += \" --pass=stdout\"\n    for exclusion in @inputExclusions()\n      command += \" | rwfilter --input-pipe=stdin\"\n      command += \" \" + exclusion\n      if config.siteConfigFile\n        command += \" --site-config-file=\" + config.siteConfigFile\n      # config.dataRootdir shouldn't be used with exclusions\n      command += \" --fail=stdout\"\n    command += \" > \" + (config.dataTempdir or \"/tmp\") + \"/\" + @_id + \".rwf\"\n    if config.isSSH and not isPresentation\n      command = config.wrapCommand(command)\n    command\n  inputOptions: (config) ->\n    if @interface is \"builder\"\n      parameters = []\n      if @typesEnabled and @types.length and _.difference(share.queryTypes, @types).length\n        value = @types.join(\",\")\n      else\n        value = \"all\"\n      parameters.push(\"--type=\" + value)\n      if @startDateType is \"interval\"\n        if @startDateEnabled and @startDate\n          parameters.push(\"--start-date=\" + @startDate)\n        if @endDateEnabled and @endDate\n          parameters.push(\"--end-date=\" + @endDate)\n        if @activeTimeEnabled and @activeTime\n          parameters.push(\"--active-time=\" + @activeTime)\n      else\n        if @startDateOffsetEnabled and @startDateOffset\n          startDateOffsetNumber = share.intval(@startDateOffset)\n          eTimeMoment = moment.utc()\n          sTimeMoment = eTimeMoment.clone().subtract(startDateOffsetNumber, 'minutes')\n          parameters.push(\"--start-date=\" + sTimeMoment.format(\"YYYY/MM/DD:HH\"))\n          parameters.push(\"--end-date=\" + eTimeMoment.format(\"YYYY/MM/DD:HH\"))\n          parameters.push(\"--active-time=\" + sTimeMoment.format(\"YYYY/MM/DDTHH:mm:ss.SSS\") + \"-\" + eTimeMoment.format(\"YYYY/MM/DDTHH:mm:ss.SSS\"))\n      if @sensorEnabled and @sensor\n        parameters.push(\"--sensor=\" + @sensor)\n      if @daddressEnabled and @daddress\n        parameters.push(\"--daddress=\" + @daddress)\n      if @saddressEnabled and @saddress\n        parameters.push(\"--saddress=\" + @saddress)\n      if @anyAddressEnabled and @anyAddress\n        parameters.push(\"--any-address=\" + @anyAddress)\n      if @dipSetEnabled and @dipSet\n        parameters.push(\"--dipset=\" + (config.dataTempdir or \"/tmp\") + \"/\" + @dipSet + \".rws\")\n      if @sipSetEnabled and @sipSet\n        parameters.push(\"--sipset=\" + (config.dataTempdir or \"/tmp\") + \"/\" + @sipSet + \".rws\")\n      if @anySetEnabled and @anySet\n        parameters.push(\"--anyset=\" + (config.dataTempdir or \"/tmp\") + \"/\" + @anySet + \".rws\")\n      if @tupleFileEnabled and @tupleFile\n        parameters.push(\"--tuple-file=\" + (config.dataTempdir or \"/tmp\") + \"/\" + @tupleFile + \".tuple\")\n      if @tupleDirectionEnabled and @tupleDirection\n        parameters.push(\"--tuple-direction=\" + @tupleDirection)\n      if @tupleDelimiterEnabled and @tupleDelimiter\n        parameters.push(\"--tuple-delimiter=\" + @tupleDelimiter)\n      if @tupleFieldsEnabled and @tupleFields\n        parameters.push(\"--tuple-fields=\" + @tupleFields)\n      if @dportEnabled and @dport\n        parameters.push(\"--dport=\" + @dport)\n      if @sportEnabled and @sport\n        parameters.push(\"--sport=\" + @sport)\n      if @aportEnabled and @aport\n        parameters.push(\"--aport=\" + @aport)\n      if @dccEnabled and @dcc.length\n        parameters.push(\"--dcc=\" + @dcc.join(\",\"))\n      if @sccEnabled and @scc.length\n        parameters.push(\"--scc=\" + @scc.join(\",\"))\n      if @protocolEnabled and @protocol\n        parameters.push(\"--protocol=\" + @protocol)\n      if @flagsAllEnabled and @flagsAll\n        parameters.push(\"--flags-all=\" + @flagsAll)\n      if @additionalParametersEnabled and @additionalParameters\n        parameters.push(@additionalParameters)\n      string = parameters.join(\" \")\n    else\n      string = @cmd\n    share.filterOptions(string)\n  inputExclusions: ->\n    exclusionsCmd = \"\"\n    if @interface is \"builder\"\n      if @additionalExclusionsCmdEnabled\n        exclusionsCmd = @additionalExclusionsCmd\n    else\n      exclusionsCmd = @exclusionsCmd\n    exclusionsCmd = share.filterOptions(exclusionsCmd)\n    _.compact(exclusionsCmd.split(/\\s+(?:OR|\\|\\|)\\s+/i))\n  outputCommand: (config, profile, isPresentation = false) ->\n    switch @output\n      when \"rwcut\"\n        @outputRwcutCommand(config, profile, isPresentation)\n      when \"rwstats\"\n        @outputRwstatsCommand(config, profile, isPresentation)\n      when \"rwcount\"\n        @outputRwcountCommand(config, profile, isPresentation)\n  outputRwcutCommand: (config, profile, isPresentation = false) ->\n    commands = []\n    if @sortField\n      rwsortOptions = [\"--fields=\" + @sortField]\n      if @sortReverse\n        rwsortOptions.push(\"--reverse\")\n      if config.siteConfigFile\n        rwsortOptions.push(\"--site-config-file=\" + config.siteConfigFile)\n      rwsortOptionsString = rwsortOptions.join(\" \")\n      rwsortOptionsString = share.filterOptions(rwsortOptionsString)\n      commands.push(\"rwsort \" + rwsortOptionsString)\n    rwcutOptions = [\"--num-recs=\" + profile.numRecs, \"--start-rec-num=\" + @startRecNum, \"--delimited\"]\n    if @fields.length\n      rwcutOptions.push(\"--fields=\" + _.intersection(@fieldsOrder, @fields).join(\",\"))\n    if config.siteConfigFile\n      rwcutOptions.push(\"--site-config-file=\" + config.siteConfigFile)\n    rwcutOptionsString = rwcutOptions.join(\" \")\n    rwcutOptionsString = share.filterOptions(rwcutOptionsString)\n    commands.push(\"rwcut \" + rwcutOptionsString)\n    commands[0] += \" \" + (config.dataTempdir or \"/tmp\") + \"/\" + @_id + \".rwf\"\n    command = commands.join(\" | \")\n    if config.isSSH and not isPresentation\n      command = config.wrapCommand(command)\n    command\n  outputRwstatsCommand: (config, profile, isPresentation = false) ->\n    defaultRwstatsOptions = [\"--delimited\"]\n    if @interface is \"builder\"\n      rwstatsOptions = defaultRwstatsOptions\n      if @rwstatsFields.length\n        rwstatsOptions.push(\"--fields=\" + _.intersection(@rwstatsFieldsOrder, @rwstatsFields).join(\",\"))\n      rwstatsValues = @rwstatsValues.slice(0)\n      rwstatsValuesOrder = @rwstatsValuesOrder.slice(0)\n      if @rwstatsPrimaryValue\n        rwstatsValues.unshift(@rwstatsPrimaryValue)\n        rwstatsValuesOrder.unshift(@rwstatsPrimaryValue)\n      if rwstatsValues.length\n        values = _.intersection(rwstatsValuesOrder, rwstatsValues)\n        for value, index in values\n          if value not in share.rwstatsValues\n            values[index] = \"distinct:\" + value\n        rwstatsOptions.push(\"--values=\" + values.join(\",\"))\n        if values[0] not in share.rwstatsValues\n          rwstatsOptions.push(\"--no-percents\")\n      rwstatsOptions.push(\"--\" + @rwstatsDirection)\n      switch @rwstatsMode\n        when \"count\"\n          rwstatsOptions.push(\"--count=\" + @rwstatsCountModeValue)\n        when \"threshold\"\n          rwstatsOptions.push(\"--threshold=\" + @rwstatsThresholdModeValue)\n        when \"percentage\"\n          rwstatsOptions.push(\"--percentage=\" + @rwstatsPercentageModeValue)\n      if @rwstatsBinTimeEnabled\n        if @rwstatsBinTime\n          rwstatsOptions.push(\"--bin-time=\" + @rwstatsBinTime)\n        else\n          rwstatsOptions.push(\"--bin-time\")\n      if config.siteConfigFile\n        rwstatsOptions.push(\"--site-config-file=\" + config.siteConfigFile)\n      rwstatsOptionsString = rwstatsOptions.join(\" \")\n    else\n      rwstatsOptionsString = @rwstatsCmd + \" \" + defaultRwstatsOptions.join(\" \")\n      rwstatsOptionsString = share.filterOptions(rwstatsOptionsString)\n    command = \"rwstats \" + rwstatsOptionsString\n    command += \" \" + (config.dataTempdir or \"/tmp\") + \"/\" + @_id + \".rwf\"\n    if config.isSSH and not isPresentation\n      command = config.wrapCommand(command)\n    command\n  outputRwcountCommand: (config, profile, isPresentation = false) ->\n    defaultRwcountOptions = [\"--delimited\", \"--no-titles\"] # --no-titles is necessary, because header is added later\n    if @interface is \"builder\"\n      rwcountOptions = defaultRwcountOptions\n      if @rwcountBinSizeEnabled\n        rwcountOptions.push(\"--bin-size=\" + @rwcountBinSize)\n      if @rwcountLoadSchemeEnabled\n        rwcountOptions.push(\"--load-scheme=\" + @rwcountLoadScheme)\n      if @rwcountSkipZeroes\n        rwcountOptions.push(\"--skip-zeroes\")\n      if config.siteConfigFile\n        rwcountOptions.push(\"--site-config-file=\" + config.siteConfigFile)\n      rwcountOptionsString = rwcountOptions.join(\" \")\n    else\n      rwcountOptionsString = @rwcountCmd + \" \" + defaultRwcountOptions.join(\" \")\n    rwcountOptionsString = share.filterOptions(rwcountOptionsString)\n    command = \"rwcount \" + rwcountOptionsString\n    command += \" \" + (config.dataTempdir or \"/tmp\") + \"/\" + @_id + \".rwf\"\n    if @presentation is \"table\"\n      if @sortField\n        fieldIndex = share.rwcountFields.indexOf(@sortField)\n        sortOptions = \"--field-separator=\\\\\\| --key=+\" + (fieldIndex + 1) + \"n\" + (if @sortReverse then \"r\" else \"\")\n        sortOptions = share.filterOptions(sortOptions, \"\\\\\\\\\\\\|\\\\+\")\n        sortCommand = \"sort \" + sortOptions\n        command += \" | \" + sortCommand\n      if profile.numRecs\n        headOptions = \"--lines=\" + (@startRecNum + profile.numRecs - 1)\n        headOptions = share.filterOptions(headOptions)\n        headCommand = \"head \" + headOptions\n        tailOptions = \"--lines=\" + profile.numRecs\n        tailOptions = share.filterOptions(tailOptions)\n        tailCommand = \"tail \" + tailOptions\n        command += \" | \" + headCommand + \" | \" + tailCommand\n    if config.isSSH and not isPresentation\n      command = config.wrapCommand(command)\n    command\n  rwstatsCountModeValueIsEnabled: ->\n    @rwstatsMode is \"count\"\n  rwstatsThresholdModeValueIsEnabled: ->\n    @rwstatsMode is \"threshold\"\n  rwstatsPercentageModeValueIsEnabled: ->\n    @rwstatsMode is \"percentage\"\n  availableChartTypes: ->\n    share.availableChartTypes[@output]\n  path: ->\n    \"/query/\" + @_id\n\nclass share.IPSet\n  constructor: (doc) ->\n    _.extend(@, doc)\n  displayName: ->\n    @name or \"#\" + @_id\n  objectSelectName: ->\n    @displayName()\n  objectSelectValue: ->\n    @_id\n  path: ->\n    \"/ipset/\" + @_id\n\nclass share.Tuple\n  constructor: (doc) ->\n    _.extend(@, doc)\n  displayName: ->\n    @name or \"#\" + @_id\n  objectSelectName: ->\n    @displayName()\n  objectSelectValue: ->\n    @_id\n  path: ->\n    \"/tuple/\" + @_id\n\nshare.Transformations =\n  user: (user) ->\n    if user instanceof share.User or not user then user else new share.User(user)\n  config: (config) ->\n    if config instanceof share.Config or not config then config else new share.Config(config)\n  query: (query) ->\n    if query instanceof share.Query or not query then query else new share.Query(query)\n  ipset: (ipset) ->\n    if ipset instanceof share.IPSet or not ipset then ipset else new share.IPSet(ipset)\n  tuple: (tuple) ->\n    if tuple instanceof share.Tuple or not tuple then tuple else new share.Tuple(tuple)\n"]}