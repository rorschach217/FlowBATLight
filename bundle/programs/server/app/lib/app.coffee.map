{"version":3,"sources":["meteor://ðŸ’»app/lib/app.coffee"],"names":["object","share","user","fields","userId","Meteor","users","findOne","intval","value","parseInt","minute","hour","datetimeFormat","rwcutFields","rwstatsValues","rwcountFields","rwcountLoadSchemes","tupleDirections","availableChartTypes","chartFieldTypes","startDateOffsets","toString","parseResult","result","i","len","ref","row","rows","split","length","push","queryTypes","inputFields","filterOptions","options","additionalPermittedCharacters","excludedOption","filter","regexp","RegExp","replace","isDebug","settings","public","window","global","console","log","_","isFunction","cl","bind"],"mappings":"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","file":"/lib/app.coffee","sourcesContent":["share = share or {}\n\n#share.combine = (funcs...) ->\n#  (args...) =>\n#    for func in funcs\n#      func.apply(@, args)\n\nshare.user = (fields, userId = Meteor.userId()) ->\n  Meteor.users.findOne(userId, {fields: fields})\n\nshare.intval = (value) ->\n  parseInt(value, 10) || 0\n\nshare.minute = 60 * 1000\nshare.hour = 60 * share.minute\n\nshare.datetimeFormat = \"YYYY/MM/DD HH:mm:ss.SSS\"\nshare.rwcutFields = [\n  \"sIP\"\n  \"dIP\"\n  \"sPort\"\n  \"dPort\"\n  \"protocol\"\n  \"packets\"\n  \"bytes\"\n  \"flags\"\n  \"sTime\"\n  \"duration\"\n  \"eTime\"\n  \"sensor\"\n  \"class\"\n  \"scc\"\n  \"dcc\"\n  \"initialFlags\"\n  \"sessionFlags\"\n  \"application\"\n  \"type\"\n  \"icmpTypeCode\"\n]\nshare.rwstatsValues = [\n  \"Records\"\n  \"Packets\"\n  \"Bytes\"\n]\nshare.rwcountFields = [\n  \"Date\"\n  \"Records\"\n  \"Bytes\"\n  \"Packets\"\n]\nshare.rwcountLoadSchemes = [\n  \"\"\n  \"bin-uniform\"\n  \"start-spike\"\n  \"end-spike\"\n  \"middle-spike\"\n  \"time-proportional\"\n  \"maximum-volume\"\n  \"minimum-volume\"\n]\nshare.tupleDirections = [\n  \"\"\n  \"both\"\n  \"forward\"\n  \"reverse\"\n]\nshare.availableChartTypes =\n  \"rwcut\": []\n  \"rwstats\": [\"BarChart\", \"ColumnChart\",  \"PieChart\"]\n  \"rwcount\": [\"LineChart\"]\nshare.chartFieldTypes =\n  \"sPort\": \"number\"\n  \"dPort\": \"number\"\n  \"protocol\": \"number\"\n  \"pro\": \"number\"\n  \"packets\": \"number\"\n  \"bytes\": \"number\"\n  \"sTime\": \"datetime\"\n  \"duration\": \"number\"\n  \"dur\": \"number\"\n  \"eTime\": \"datetime\"\n  \"Records\": \"number\"\n  \"Packets\": \"number\"\n  \"Bytes\": \"number\"\n  \"Date\": \"datetime\"\n  \"cumul_%\": \"number\"\nshare.startDateOffsets =\n  \"Hour\": (60).toString()\n  \"Day\": (24 * 60).toString()\n  \"Week\": (7 * 24 * 60).toString()\n  \"Month\": (30 * 24 * 60).toString()\n\nshare.parseResult = (result) ->\n  rows = []\n  for row in result.split(\"\\n\")\n    rows.push(row.split(\"|\"))\n  rows\n\nshare.queryTypes = [\"in\", \"out\", \"inweb\", \"outweb\", \"inicmp\", \"outicmp\", \"innull\", \"outnull\", \"int2int\", \"ext2ext\", \"other\"]\nshare.inputFields = [\n  \"interface\"\n  \"cmd\"\n  \"exclusionsCmd\"\n  \"startDateEnabled\"\n  \"startDate\"\n  \"endDateEnabled\"\n  \"endDate\"\n  \"sensorEnabled\"\n  \"sensor\"\n  \"typesEnabled\"\n  \"types\"\n  \"daddressEnabled\"\n  \"daddress\"\n  \"saddressEnabled\"\n  \"saddress\"\n  \"anyAddressEnabled\"\n  \"anyAddress\"\n  \"dipSetEnabled\"\n  \"dipSet\"\n  \"sipSetEnabled\"\n  \"sipSet\"\n  \"anySetEnabled\"\n  \"anySet\"\n  \"tupleFileEnabled\"\n  \"tupleFile\"\n  \"tupleDirectionEnabled\"\n  \"tupleDirection\"\n  \"tupleDelimiterEnabled\"\n  \"tupleDelimiter\"\n  \"tupleFieldsEnabled\"\n  \"tupleFields\"\n  \"dportEnabled\"\n  \"dport\"\n  \"sportEnabled\"\n  \"sport\"\n  \"aportEnabled\"\n  \"aport\"\n  \"dccEnabled\"\n  \"dcc\"\n  \"sccEnabled\"\n  \"scc\"\n  \"protocolEnabled\"\n  \"protocol\"\n  \"flagsAllEnabled\"\n  \"flagsAll\"\n  \"activeTimeEnabled\"\n  \"activeTime\"\n  \"additionalParametersEnabled\"\n  \"additionalParameters\"\n  \"additionalExclusionsCmdEnabled\"\n  \"additionalExclusionsCmd\"\n]\n\nshare.filterOptions = (options, additionalPermittedCharacters = \"\") ->\n  for excludedOption in [\"--python-expr\", \"--python-file\", \"--pmap\", \"--dynamic-library\", \"--all-destination\", \"--fail-destination\", \"--pass-destination\", \"--print-statistics\", \"--print-volume-statistics\", \"--xargs\"]\n    regexp = new RegExp(excludedOption + \"=?[^\\\\s]*\", \"gi\")\n    options = options.replace(regexp, \"\")\n  filter = new RegExp(\"[^\\\\s\\\\=\\\\-\\\\/\\\\,\\\\.\\\\:0-9a-z_\" + additionalPermittedCharacters + \"]\", \"gi\")\n  options = options.replace(filter, \"\")\n  options\n\nshare.isDebug = Meteor.settings.public.isDebug\n\nobject = if typeof(window) != \"undefined\" then window else global\nobject.isDebug = share.isDebug\nif typeof(console) != \"undefined\" && console.log && _.isFunction(console.log)\n  object.cl = _.bind(console.log, console)\nelse\n  object.cl = ->\n"]}